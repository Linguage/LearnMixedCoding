# VS Code 项目配置说明

## 功能概述

本项目的 VS Code 配置主要用于支持 C/C++ 和 Fortran 开发环境，提供了自动化的编译、执行和调试功能。通过预设任务（Tasks）和启动配置（Launch），简化了多语言项目的开发流程。

## 配置文件说明

`.vscode` 目录包含以下配置文件：

- `tasks.json`: 定义编译和执行任务
- `launch.json`: 定义调试配置 (如需调试功能请添加此文件)
- `settings.json`: 项目特定的编辑器设置 (可选)
- `c_cpp_properties.json`: C/C++ 扩展配置 (可选)

## 任务（Tasks）功能

本项目包含以下预定义任务：

1. **创建build目录**
   - 功能：自动创建 build 目录用于存放编译产物
   - 作为其他编译任务的依赖项自动执行

2. **C/C++: clang++ 生成活动文件**
   - 功能：编译当前打开的 C/C++ 源文件
   - 语法标准：C++17
   - 输出：在 build 目录中生成与源文件同名的可执行文件
   - 包含调试信息（-g 参数）

3. **执行已编译程序**
   - 功能：执行编译后的 C/C++ 程序
   - 依赖：自动触发编译任务

4. **Fortran: gfortran 编译活动文件**
   - 功能：编译当前打开的 Fortran 源文件
   - 输出：在 build 目录中生成与源文件同名的可执行文件
   - 包含调试信息

5. **执行已编译Fortran程序**
   - 功能：执行编译后的 Fortran 程序

## 使用方法

### 编译和运行 C/C++ 程序

1. 打开要编译的 `.cpp` 或 `.c` 文件
2. 使用以下方法之一触发任务：
   - 按下 `Ctrl+Shift+B`（默认构建快捷键）
   - 命令面板（`Ctrl+Shift+P`）中选择 "Run Build Task"
   - 终端菜单 → "Run Build Task"
3. 如需执行编译后的程序：
   - 命令面板中选择 "Run Test Task"
   - 选择 "执行已编译程序" 任务

### 编译和运行 Fortran 程序

1. 打开要编译的 `.f90` 或 `.f` 文件
2. 命令面板中选择 "Run Task"
3. 选择 "Fortran: gfortran 编译活动文件" 任务
4. 运行程序时选择 "执行已编译Fortran程序" 任务

## 配置原理和构建原则

### 构建原则

1. **分离编译与执行**
   - 编译和执行被分为独立任务，方便调试和检查中间结果

2. **统一输出目录**
   - 所有编译产物统一输出到 `build` 目录
   - 避免源代码目录被编译产物污染

3. **语言无关的工作流**
   - 为不同语言（C/C++、Fortran）提供相同的工作流体验
   - 降低在多语言项目中切换的认知负担

4. **依赖自动化**
   - 通过任务依赖关系（dependsOn）确保前置任务自动完成
   - 例如：运行程序前自动完成编译，编译前自动创建必要的目录

### 技术实现

任务定义采用 VS Code 的任务系统（Task System），主要设计思路：

1. **Shell 命令执行**：所有任务通过 shell 命令执行，确保可在终端复现
2. **变量替换**：使用 VS Code 预定义变量如 `${file}`、`${workspaceFolder}` 等实现灵活配置
3. **任务分组**：通过 `group` 属性将任务归类为 "build" 或 "test"，便于快捷键绑定
4. **任务依赖**：通过 `dependsOn` 属性建立任务间的依赖关系

## 扩展建议

为了获得最佳体验，建议安装以下 VS Code 扩展：

- **C/C++**：提供智能补全、语法高亮、调试等功能
- **Modern Fortran**：提供 Fortran 语法支持
- **Code Runner**：快速运行代码片段

## 自定义配置

您可以根据项目需求修改以下配置：

1. 在 `tasks.json` 中调整编译器参数、优化级别等
2. 添加新的编译或运行任务
3. 创建或修改 `launch.json` 以添加调试配置

## 代码片段（Snippets）使用指南

本项目配置了适用于 C/C++ 和 Fortran 开发的代码片段，可显著提高编码效率。

### 什么是代码片段

代码片段是可以快速插入编辑器的预定义代码模板，通过简短的触发前缀调用。

### 如何使用代码片段

1. 在编辑器中输入触发前缀（如 `main`）
2. 编辑器会显示匹配的代码片段列表
3. 按 `Tab` 或 `Enter` 插入所选代码片段
4. 使用 `Tab` 在代码片段的可编辑位置间跳转

### 可用的代码片段

#### C/C++ 代码片段

| 触发前缀 | 描述 | 插入内容 |
|---------|------|---------|
| `main` | 主函数模板 | 完整的 main 函数框架 |
| `inc` | 包含头文件 | `#include <>` 语句 |
| `for` | for循环 | 标准 for 循环结构 |
| `while` | while循环 | while 循环结构 |
| `if` | if语句 | if 条件语句 |
| `class` | 类定义 | 类定义模板 |
| `func` | 函数定义 | 函数定义模板 |

#### Fortran 代码片段

| 触发前缀 | 描述 | 插入内容 |
|---------|------|---------|
| `prog` | 程序模板 | 完整的程序框架 |
| `sub` | 子程序 | 子程序模板 |
| `func` | 函数 | 函数模板 |
| `do` | do循环 | do 循环结构 |
| `if` | if语句 | if-then-else 结构 |
| `mod` | 模块 | 模块定义模板 |

### 自定义代码片段

您可以通过以下步骤创建自己的代码片段：

1. 打开命令面板（`Ctrl+Shift+P` 或 `Cmd+Shift+P`）
2. 输入并选择 "Preferences: Configure User Snippets"
3. 选择语言（如 "C", "C++" 或 "Fortran"）或创建新的代码片段文件
4. 按以下格式添加新的代码片段：

```json
"片段名称": {
  "prefix": "触发前缀",
  "body": [
    "第一行",
    "第二行",
    "${1:可选占位符}"
  ],
  "description": "片段描述"
}
```

### 代码片段技巧

- 使用 `${1:默认文本}`, `${2:默认文本}` 等创建可编辑占位符
- 使用 `$0` 设置最终光标位置
- 在快速插入重复代码模式时，代码片段比复制粘贴更高效
- 为常用的代码模式创建自定义片段，提高开发效率
